(function(b,a){if("undefined"===typeof a){return}if("undefined"===typeof a.updates){return}var d=b(document);var c={};c.l10n=b.extend(pluginManagerSettings,a.updates.l10n);c.currentAction=null;c.namespace=null;c.queue=[];c.installPlugin=function(e){e=_.extend({success:c.refreshRow,error:c.refreshRow},e);d.trigger("wp-plugin-installing",e);return a.updates.ajax("install-plugin",e)};c.updatePlugin=function(e){e=_.extend({success:c.refreshRow,error:c.refreshRow},e);d.trigger("wp-plugin-updating",e);return a.updates.ajax("update-plugin",e)};c.deletePlugin=function(e){e=_.extend({success:c.refreshRow,error:c.refreshRow},e);d.trigger("wp-plugin-deleting",e);return a.updates.ajax("delete-plugin",e)};c.refreshRow=function(f){var g={_ajax_nonce:a.updates.ajaxNonce,action:"plugin-manager-row-refresh",prev_action:c.currentAction,slug:f.slug,namespace:c.namespace,error:null,error_level:"error"};if(f.errorMessage){if("update-plugin"===g.prev_action&&f.debug){g.error=f.debug[0];g.error_level="warning"}else{g.error=f.errorMessage}if(f.errorLevel){g.error_level=f.errorLevel}}var e=b('tr[data-slug="'+g.slug+'"]');b.post(ajaxurl,g,function(h){b("#setting-error-plugin-manager-error").remove();b("."+g.slug+"-notice").remove();b('tr[data-slug="'+g.slug+'"]').replaceWith(h);var i=b('tr[data-slug="'+g.slug+'"]');if(i.hasClass("ajax-success")){setTimeout(function(){i.removeClass("install-success update-success delete-success")},200)}c.currentAction=null;c.processQueue()})};c.processQueue=function(){if(!c.queue.length){return}var g=c.queue[0],f=g.action,e=g.row;c.queue.shift();if("install-selected"===f){e.addClass("updating-message").find(".row-actions").text(c.l10n.installing);c.currentAction="install-plugin";if("third-party"===e.data("source")){c.refreshRow({slug:g.slug,plugin:g.plugin,errorMessage:c.l10n.thirdParty,errorLevel:"warning"})}else{c.installPlugin({slug:g.slug})}}else{if("update-selected"===f){e.addClass("updating-message").find(".row-actions").text(c.l10n.updating);c.currentAction="update-plugin";if("not-installed"===e.data("status")){c.refreshRow({slug:g.slug,plugin:g.plugin,errorMessage:c.l10n.notInstalled,errorLevel:"warning"})}else{c.updatePlugin({slug:g.slug,plugin:g.plugin})}}else{if("delete-selected"===f){if("not-installed"==e.data("status")){c.refreshRow({slug:g.slug,plugin:g.plugin})}else{e.addClass("updating-message").find(".row-actions").text(c.l10n.deleting);c.currentAction="delete-plugin";c.deletePlugin({slug:g.slug,plugin:g.plugin})}}}}};d.ready(function(f){var e=f("#suggested-plugins");c.namespace=e.find("form").data("namespace");e.on("click",".install-now",function(i){i.preventDefault();var h=f(i.target),g=h.closest("tr");if(g.hasClass("updating-message")){return}g.addClass("updating-message").find(".row-actions").text(c.l10n.installing);c.currentAction="install-plugin";c.installPlugin({slug:g.data("slug")})});e.on("click",".update-now",function(i){i.preventDefault();var h=f(i.target),g=h.closest("tr");if(g.hasClass("updating-message")){return}g.addClass("updating-message").find(".row-actions").text(c.l10n.updating);c.currentAction="update-plugin";c.updatePlugin({slug:g.data("slug"),plugin:g.data("plugin")})});e.on("click",".delete-now",function(i){i.preventDefault();var h=f(i.target),g=h.closest("tr");if(g.hasClass("updating-message")){return}if(!window.confirm(a.updates.l10n.aysDeleteUninstall.replace("%s",g.find(".plugin-title strong").text()))){return}g.addClass("updating-message").find(".row-actions").text(c.l10n.deleting);c.currentAction="delete-plugin";c.deletePlugin({slug:g.data("slug"),plugin:g.data("plugin")})});e.on("click","#do-action-top, #do-action-bottom",function(h){h.preventDefault();var j=f(this),i=j.prev("select").val(),g=j.closest("form");if("activate-selected"==i||"deactivate-selected"==i){g.submit();return}g.find('input[name="checked[]"]:checked').each(function(){var l=f(this),k=l.closest("tr");c.queue.push({row:k,slug:l.val(),plugin:k.data("plugin"),action:i})});g.find('input[type="checkbox"]').attr("checked",false);g.find("select").val("-1");c.processQueue()})})})(jQuery,window.wp);